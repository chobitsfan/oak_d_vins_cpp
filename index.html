<!DOCTYPE html>
<html>
<body>

<script>
setTimeout(function(){
    setInterval(drawBB, 1000);
}, 5000);
function drawBB() {
    var request = new XMLHttpRequest(); 
	request.open("GET", "/bar");
	request.send();
	request.onreadystatechange = function() {
		if (request.readyState == 4 && request.status == 200) {
            const overlay = document.getElementById("overlay");
            const ctx = overlay.getContext("2d");
            if (bb_pts == "no barcode") {
                ctx.clearRect(0, 0, overlay.width, overlay.height);
            } else {
                ctx.clearRect(0, 0, overlay.width, overlay.height);
                var bb_pts = request.responseText.split(",");
                ctx.beginPath();
                ctx.strokeStyle = "red";
                ctx.moveTo(bb_pts[0], bb_pts[1]);
                ctx.lineTo(bb_pts[2], bb_pts[3]);
                ctx.lineTo(bb_pts[4], bb_pts[5]);
                ctx.lineTo(bb_pts[6], bb_pts[7]);
                ctx.closePath();
                ctx.stroke();
                ctx.font = "20px serif";
                ctx.fillText(bb_pts[8], bb_pts[2], bb_pts[3] - 10);
            }
        }
	}
}
</script>
<div>
    <img src="/cam" style="position:absolute;z-index:1;" />
    <canvas id="overlay" width="640" height="400" style="position:relative;z-index:20;"/>
</div>

</body>
</html>
